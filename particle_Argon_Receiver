// Array to temporarily store the current sensor values received
int sensorValues[5] = {0};

void setup() {
    // Initialize the serial monitor
    Serial.begin(9600);

    // Print a startup message
    Serial.println("Waiting for sensor data...");

    // Subscribe to the published data
    Particle.subscribe("flexSensorData", handleSensorData, MY_DEVICES);
}

void loop() {
    // The loop remains empty because data is processed in the subscription callback
}

// Function to handle and process received sensor data
void handleSensorData(const char *event, const char *data) {
    // Print the received raw data for debugging
    Serial.println("Received data: " + String(data));

    // Parse the received string and convert it to integer values
    sscanf(data, "%d,%d,%d,%d,%d", &sensorValues[0], &sensorValues[1], &sensorValues[2], &sensorValues[3], &sensorValues[4]);

    // Print the individual sensor values
    for (int i = 0; i < 5; i++) {
        Serial.print("Sensor ");
        Serial.print(i + 1);
        Serial.print(": ");
        Serial.println(sensorValues[i]);

        // Clear the value after printing
        sensorValues[i] = 0;
    }

    // Add a line break for clarity
    Serial.println("---------------------");
}
